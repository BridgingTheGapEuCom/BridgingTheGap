<template>
  <div
    aria-label="Illustration depicting a one-way peer-to-peer messaging architecture. System A publishes messages to a topic within the message broker, and System B subscribes to that topic to receive the messages."
    class="syncSvgParent w-full sm:w-9/12"
    role="img"
    tabindex="0"
  >
    <svg
      height="125px"
      style="background: transparent; background-color: transparent"
      viewBox="-0.5 -0.5 354 125"
      width="354px"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <defs />
      <g>
        <g />
        <g>
          <svg
            height="77"
            style="height: 77px; width: 77px"
            viewBox="0 0 850 850"
            width="77"
            x="0"
            y="18"
          >
            <g>
              <path
                class="top"
                d="M 230 280 l 157.18 72.352 c 20.668 9.5156 54.496 9.5156 75.145 0 l 132.64 -61.055 l 217.53 -103.74 c -4.5742 -3.4336 -9.25 -6.5156 -14.191 -8.7734 l -317.09 -146.01 c -30.992 -14.277 -81.746 -14.277 -112.76 0 l -317.19 146.01 c -5.0703 2.3164 -9.8672 5.5234 -14.543 9.0625 z"
              />
              <path
                class="left"
                d="m 423.34 420.96 c 0 -22.801 -16.902 -49.16 -37.574 -58.695 l -239.42 -110.15 c -0.207 -0.082 -0.3711 -0.25 -0.5781 -0.3516 l -108.25 -49.883 v 372.25 c 0 34.137 25.387 73.738 56.398 88.035 l 317.19 146.03 c 2.8125 1.3047 5.957 2.3398 9.0625 3.3945 l 3.1445 -193.8 l 0.0039 -196.82 z"
              />
              <path
                class="right"
                d="m 708.59 250.96 c -0.4336 0.2266 -0.8086 0.5391 -1.2812 0.7656 l -239.46 110.21 c -20.691 9.4961 -37.574 35.918 -37.574 58.676 v 162.12 l 0.4766 -0.0195 l -0.7461 229.8 c 4.4688 -1.3438 8.7109 -2.9375 12.621 -4.7383 l 317.17 -146.03 c 30.992 -14.277 56.398 -53.875 56.398 -88.035 l -0.0625 -372.39 z"
              />
            </g>
          </svg>
        </g>
        <g>
          <rect
            fill="none"
            height="30"
            pointer-events="all"
            stroke="none"
            width="60"
            x="8.5"
            y="94"
          />
        </g>
        <g>
          <g transform="translate(-0.5 -0.5)">
            <switch>
              <foreignObject
                height="100%"
                pointer-events="none"
                style="overflow: visible; text-align: left"
                width="100%"
                ><div
                  style="
                    display: flex;
                    align-items: unsafe center;
                    justify-content: unsafe center;
                    width: 58px;
                    height: 1px;
                    padding-top: 109px;
                    margin-left: 10px;
                  "
                  xmlns="http://www.w3.org/1999/xhtml"
                >
                  <div style="box-sizing: border-box; font-size: 0; text-align: center">
                    <div
                      style="
                        display: inline-block;
                        font-size: 12px;
                        font-family: 'Atkinson Hyperlegible', serif;
                        line-height: 1.2;
                        pointer-events: all;
                        white-space: normal;
                        word-wrap: normal;
                      "
                    >
                      System A
                    </div>
                  </div>
                </div></foreignObject
              >
              <text font-size="12px" text-anchor="middle" x="39" y="113">System A</text>
            </switch>
          </g>
        </g>
        <g />
        <g>
          <svg
            height="77"
            style="height: 77px; width: 77px"
            viewBox="0 0 850 850"
            width="77"
            x="276.5"
            y="19.5"
          >
            <g>
              <path
                class="top"
                d="M 230 280 l 157.18 72.352 c 20.668 9.5156 54.496 9.5156 75.145 0 l 132.64 -61.055 l 217.53 -103.74 c -4.5742 -3.4336 -9.25 -6.5156 -14.191 -8.7734 l -317.09 -146.01 c -30.992 -14.277 -81.746 -14.277 -112.76 0 l -317.19 146.01 c -5.0703 2.3164 -9.8672 5.5234 -14.543 9.0625 z"
              />
              <path
                class="left"
                d="m 423.34 420.96 c 0 -22.801 -16.902 -49.16 -37.574 -58.695 l -239.42 -110.15 c -0.207 -0.082 -0.3711 -0.25 -0.5781 -0.3516 l -108.25 -49.883 v 372.25 c 0 34.137 25.387 73.738 56.398 88.035 l 317.19 146.03 c 2.8125 1.3047 5.957 2.3398 9.0625 3.3945 l 3.1445 -193.8 l 0.0039 -196.82 z"
              />
              <path
                class="right"
                d="m 708.59 250.96 c -0.4336 0.2266 -0.8086 0.5391 -1.2812 0.7656 l -239.46 110.21 c -20.691 9.4961 -37.574 35.918 -37.574 58.676 v 162.12 l 0.4766 -0.0195 l -0.7461 229.8 c 4.4688 -1.3438 8.7109 -2.9375 12.621 -4.7383 l 317.17 -146.03 c 30.992 -14.277 56.398 -53.875 56.398 -88.035 l -0.0625 -372.39 z"
              />
            </g>
          </svg>
        </g>
        <g>
          <rect
            fill="none"
            height="30"
            pointer-events="all"
            stroke="none"
            width="60"
            x="285.5"
            y="94"
          />
        </g>
        <g>
          <g transform="translate(-0.5 -0.5)">
            <switch>
              <foreignObject
                height="100%"
                pointer-events="none"
                style="overflow: visible; text-align: left"
                width="100%"
                ><div
                  style="
                    display: flex;
                    align-items: unsafe center;
                    justify-content: unsafe center;
                    width: 58px;
                    height: 1px;
                    padding-top: 109px;
                    margin-left: 287px;
                  "
                  xmlns="http://www.w3.org/1999/xhtml"
                >
                  <div style="box-sizing: border-box; font-size: 0; text-align: center">
                    <div
                      style="
                        display: inline-block;
                        font-size: 12px;
                        font-family: 'Atkinson Hyperlegible', serif;
                        line-height: 1.2;
                        pointer-events: all;
                        white-space: normal;
                        word-wrap: normal;
                      "
                    >
                      System B
                    </div>
                  </div>
                </div></foreignObject
              >
              <text
                fill="light-dark(#000000, #ffffff)"
                font-family='"Helvetica"'
                font-size="12px"
                text-anchor="middle"
                x="316"
                y="113"
              >
                System B
              </text>
            </switch>
          </g>
        </g>
        <g>
          <path
            class="arrow"
            d="M 77 58.5 L 130.63 58.5"
            fill="none"
            pointer-events="stroke"
            stroke="#000000"
            stroke-miterlimit="10"
          />
          <path
            class="arrow"
            d="M 135.88 58.5 L 128.88 62 L 130.63 58.5 L 128.88 55 Z"
            fill="#000000"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            class="arrow"
            d="M 217 58.5 L 270.63 58.5"
            fill="none"
            pointer-events="stroke"
            stroke-miterlimit="10"
          />
          <path
            class="arrow"
            d="M 275.88 58.5 L 268.88 62 L 270.63 58.5 L 268.88 55 Z"
            pointer-events="all"
            stroke-miterlimit="10"
          />
        </g>
        <g />
        <g>
          <path
            class="topicBackground topicPathColor"
            d="M 167 23.5 C 167 20.74 171.48 18.5 177 18.5 C 179.65 18.5 182.2 19.03 184.07 19.96 C 185.95 20.9 187 22.17 187 23.5 L 187 93.5 C 187 96.26 182.52 98.5 177 98.5 C 171.48 98.5 167 96.26 167 93.5 Z"
            pointer-events="all"
            stroke-miterlimit="10"
            transform="rotate(90,177,58.5)"
          />
          <path
            class="topicPathColor"
            d="M 187 23.5 C 187 26.26 182.52 28.5 177 28.5 C 171.48 28.5 167 26.26 167 23.5"
            fill="none"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            transform="rotate(90,177,58.5)"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 163 52.23 L 173 58.5 L 163 64.76 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 147 52.23 L 157 58.5 L 147 64.76 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            d="M 173 55.5 L 178 52.24 L 181.32 52.24"
            fill="none"
            pointer-events="stroke"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
          <path
            d="M 182.44 52.24 L 180.94 52.99 L 181.32 52.24 L 180.94 51.49 Z"
            fill="#000000"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            d="M 173 61.5 L 178 64.76 L 181.32 64.76"
            fill="none"
            pointer-events="stroke"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
          <path
            d="M 182.44 64.76 L 180.94 65.51 L 181.32 64.76 L 180.94 64.01 Z"
            fill="#000000"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            d="M 174 58.45 L 182.32 58.45"
            fill="none"
            pointer-events="stroke"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
          <path
            d="M 183.44 58.45 L 181.94 59.2 L 182.32 58.45 L 181.94 57.7 Z"
            fill="#000000"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 191 50.7 L 194 52.2 L 191 53.7 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 185 50.7 L 188 52.2 L 185 53.7 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 191 57 L 194 58.5 L 191 60 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 185 57 L 188 58.5 L 185 60 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 191 63.3 L 194 64.8 L 191 66.3 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 185 63.3 L 188 64.8 L 185 66.3 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 197 57 L 200 58.5 L 197 60 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 197 50.7 L 200 52.2 L 197 53.7 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g>
          <path
            class="topicTriangle"
            d="M 197 63.3 L 200 64.8 L 197 66.3 Z"
            fill="#ffffff"
            pointer-events="all"
            stroke="#000000"
            stroke-miterlimit="10"
            stroke-width="0.5"
          />
        </g>
        <g />
        <g>
          <rect
            class="messageBrokerBorders"
            fill="none"
            height="120"
            pointer-events="all"
            stroke="#374151"
            stroke-dasharray="1 4"
            width="160"
            x="97"
            y="0"
          />
        </g>
        <g />
        <g>
          <rect
            class="messageBrokerBackground"
            height="25"
            pointer-events="all"
            width="25"
            x="97"
            y="0"
          />
        </g>
        <g>
          <rect
            class="messageBrokerLogo"
            fill="none"
            height="8.83"
            pointer-events="all"
            stroke="#ffffff"
            width="14.06"
            x="104.81"
            y="8.09"
          />
          <path
            class="messageBrokerLogo"
            d="M 104.81 8.09 L 111.84 15.31 L 118.88 8.09 M 104.81 16.92 L 109.17 12.5 M 118.88 16.92 L 114.52 12.5"
            pointer-events="all"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            class="messageBrokerLogo"
            d="M 98.56 9.38 L 104.81 9.38"
            fill="none"
            pointer-events="stroke"
            stroke="#ffffff"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            class="messageBrokerLogo"
            d="M 99.5 10.63 L 104.81 10.63"
            fill="none"
            pointer-events="stroke"
            stroke="#ffffff"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <path
            class="messageBrokerLogo"
            d="M 100.44 11.88 L 104.81 11.88"
            fill="none"
            pointer-events="stroke"
            stroke="#ffffff"
            stroke-miterlimit="10"
          />
        </g>
        <g>
          <rect
            fill="none"
            height="22.5"
            pointer-events="all"
            stroke="none"
            width="130"
            x="127"
            y="0"
          />
        </g>
        <g>
          <g transform="translate(-0.5 -0.5)">
            <switch>
              <foreignObject
                height="100%"
                pointer-events="none"
                style="overflow: visible; text-align: left"
                width="100%"
                ><div
                  style="
                    display: flex;
                    align-items: unsafe center;
                    justify-content: unsafe flex-start;
                    width: 128px;
                    height: 1px;
                    padding-top: 13px;
                    margin-left: 129px;
                  "
                  xmlns="http://www.w3.org/1999/xhtml"
                >
                  <div style="box-sizing: border-box; font-size: 0; text-align: left">
                    <div
                      style="
                        display: inline-block;
                        font-size: 12px;
                        line-height: 1.2;
                        pointer-events: all;
                        white-space: normal;
                        word-wrap: normal;
                      "
                    >
                      Message Broker
                    </div>
                  </div>
                </div></foreignObject
              >
              Message Broker
            </switch>
          </g>
        </g>
      </g>
    </svg>
  </div>
</template>

<script lang="ts" setup>
import { computed } from 'vue'

const props = defineProps(['dark'])

const isDark = computed(() => {
  return props.dark
})

const switchThemeColor = () => {
  if (document) {
    const root = document.querySelector(':root')
    if (root) {
      if (isDark.value) {
        root.style.setProperty('--color', `var(--tw-color-white)`)

        root.style.setProperty('--topicFillColor', `var(--tw-color-gray-200)`)
        root.style.setProperty('--topicTriangleFillColor', `var(--tw-color-gray-100)`)
        root.style.setProperty('--topicPathColor', `var(--tw-color-gray-400)`)

        root.style.setProperty('--messageBrokerBackground', `var(--tw-color-gray-100)`)
        root.style.setProperty('--messageBrokerLogoStroke', `var(--tw-color-gray-700)`)

        root.style.setProperty('--messageBrokerBorders', `var(--tw-color-gray-100)`)

        root.style.setProperty('--themeTop', `var(--tw-color-gray-50)`)
        root.style.setProperty('--themeLeft', `var(--tw-color-gray-200)`)
        root.style.setProperty('--themeRight', `var(--tw-color-gray-400)`)
      } else {
        root.style.setProperty('--color', `var(--tw-color-black)`)

        root.style.setProperty('--topicFillColor', `var(--tw-color-gray-300)`)
        root.style.setProperty('--topicTriangleFillColor', `var(--tw-color-gray-100)`)
        root.style.setProperty('--topicPathColor', `var(--tw-color-black)`)

        root.style.setProperty('--messageBrokerBackground', `var(--tw-color-gray-500)`)
        root.style.setProperty('--messageBrokerLogoStroke', `var(--tw-color-gray-100)`)

        root.style.setProperty('--messageBrokerBorders', `var(--tw-color-gray-900)`)

        root.style.setProperty('--themeTop', `var(--tw-color-gray-500)`)
        root.style.setProperty('--themeLeft', `var(--tw-color-gray-600)`)
        root.style.setProperty('--themeRight', `var(--tw-color-gray-800)`)
      }
    }
  }
}

switchThemeColor()

watch(isDark, () => {
  switchThemeColor()
})
</script>

<style scoped>
.syncSvgParent {
  transition: var(--diagramColorTransition);
  color: var(--color);
}

.arrow {
  transition: var(--diagramColorTransition);
  stroke: var(--color);
  fill: var(--color);
}

.topicBackground {
  transition: var(--diagramColorTransition);
  fill: var(--topicFillColor);
}

.topicTriangle {
  transition: var(--diagramColorTransition);
  fill: var(--topicTriangleFillColor);
}

.topicPathColor {
  transition: var(--diagramColorTransition);
  stroke: var(--topicPathColor);
}

.messageBrokerBackground {
  transition: var(--diagramColorTransition);
  stroke: var(--messageBrokerBackground);
  fill: var(--messageBrokerBackground);
}

.messageBrokerLogo {
  stroke: var(--messageBrokerLogoStroke);
  fill: transparent;
}

.messageBrokerBorders {
  stroke: var(--messageBrokerBorders);
}

.top {
  transition: var(--diagramColorTransition);
  fill: var(--themeTop);
  stroke: black;
  stroke-width: 2;
}
.left {
  transition: var(--diagramColorTransition);
  fill: var(--themeLeft);
  stroke: black;
  stroke-width: 2;
}
.right {
  transition: var(--diagramColorTransition);
  fill: var(--themeRight);
  stroke: black;
  stroke-width: 2;
}
</style>
