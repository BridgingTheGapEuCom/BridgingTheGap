<template>
  <div
    tabindex="0"
    aria-label="A sequence diagram showing the interaction between two applications, App 1 and App 2. App 1 sends a 'call()' message to App 2, which then responds with a 'response()' message."
    role="img"
    class="syncSvgParent"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="304px"
      height="273px"
      viewBox="-0.5 -0.5 304 273"
    >
      <defs />
      <g>
        <g data-cell-id="SVuZOGWYkYCsWBmD4lxg-0">
          <g data-cell-id="SVuZOGWYkYCsWBmD4lxg-1">
            <g data-cell-id="nWIznAXhC5FFgTAuVmWS-1">
              <g>
                <path
                  class="path"
                  d="M 51.15 103 L 51.25 61"
                  stroke-miterlimit="10"
                  stroke-dasharray="3 3"
                  pointer-events="stroke"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-0">
              <g />
              <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-1">
                <g>
                  <rect
                    class="rect"
                    x="0"
                    y="1"
                    width="102.5"
                    height="60"
                    rx="9"
                    ry="9"
                    pointer-events="all"
                  />
                </g>
                <g>
                  <g transform="translate(-0.5 -0.5)">
                    <switch>
                      <foreignObject
                        pointer-events="none"
                        width="100%"
                        height="100%"
                        style="overflow: visible; text-align: left"
                      >
                        <div
                          xmlns="http://www.w3.org/1999/xhtml"
                          style="
                            display: flex;
                            align-items: unsafe center;
                            justify-content: unsafe center;
                            width: 101px;
                            height: 1px;
                            padding-top: 31px;
                            margin-left: 1px;
                          "
                        >
                          <div
                            data-drawio-colors="color: rgb(0, 0, 0); "
                            style="box-sizing: border-box; font-size: 0; text-align: center"
                          >
                            <div
                              style="
                                display: inline-block;
                                font-size: 12px;
                                font-family: 'Atkinson Hyperlegible', serif;
                                line-height: 1.2;
                                pointer-events: all;
                                white-space: normal;
                                overflow-wrap: normal;
                              "
                            >
                              <b>App 1</b>
                            </div>
                          </div>
                        </div>
                      </foreignObject>
                      <text
                        x="51"
                        y="35"
                        fill="rgb(0, 0, 0)"
                        font-family='"Atkinson Hyperlegible"'
                        font-size="1rem"
                        text-anchor="middle"
                      >
                        App 1
                      </text>
                    </switch>
                  </g>
                </g>
              </g>
              <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-2">
                <g>
                  <rect
                    x="80"
                    y="6"
                    width="16.1"
                    height="15"
                    fill="none"
                    stroke="none"
                    pointer-events="all"
                  />
                  <path
                    d="M 81.05 16.55 L 95.05 16.55 L 95.05 7.17 L 81.05 7.17 Z M 80.8 17.72 C 80.44 17.72 80 17.33 80 16.8 L 80 6.94 C 80 6.44 80.4 6 80.79 6 L 95.3 6 C 95.72 6 96.1 6.46 96.1 6.92 L 96.1 16.79 C 96.1 17.21 95.8 17.72 95.27 17.72 L 89.89 17.72 C 89.8 18.07 89.72 18.42 89.72 18.76 C 89.72 19.34 90.02 19.57 90.47 19.7 C 91.02 19.84 91.61 19.84 92.19 19.85 C 92.44 19.85 92.71 20.08 92.71 20.45 C 92.71 20.74 92.47 21 92.25 21 L 83.84 21 C 83.6 21 83.35 20.75 83.35 20.46 C 83.35 20.12 83.56 19.85 83.85 19.85 C 84.53 19.83 85.42 19.84 85.94 19.58 C 86.17 19.45 86.36 19.26 86.38 18.84 C 86.4 18.47 86.3 18.09 86.21 17.72 Z"
                    class="systemIcon"
                    stroke="none"
                  />
                </g>
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-5">
              <g>
                <path
                  d="M 51 269 L 51 231"
                  class="path"
                  stroke-miterlimit="10"
                  stroke-dasharray="3 3"
                  pointer-events="stroke"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-13">
              <g>
                <path
                  d="M 46 137 L 232 137 L 230.39 136.97"
                  class="path"
                  stroke-miterlimit="10"
                  pointer-events="stroke"
                />
                <path
                  d="M 240.39 137.14 L 230.3 141.97 L 230.47 131.97 Z"
                  class="pathFilled"
                  stroke-miterlimit="10"
                  pointer-events="all"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-4">
              <g>
                <rect
                  class="execution"
                  x="42"
                  y="103"
                  width="18"
                  height="128"
                  rx="2.7"
                  ry="2.7"
                  pointer-events="all"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-6">
              <g>
                <path
                  d="M 251.41 129 L 251.25 60"
                  class="path"
                  stroke-miterlimit="10"
                  stroke-dasharray="3 3"
                  pointer-events="stroke"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-7">
              <g />
              <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-8">
                <g>
                  <rect
                    class="rect"
                    x="200"
                    y="0"
                    width="102.5"
                    height="60"
                    rx="9"
                    ry="9"
                    fill="#f3f4f6"
                    stroke="#6b7280"
                    pointer-events="all"
                  />
                </g>
                <g>
                  <g transform="translate(-0.5 -0.5)">
                    <switch>
                      <foreignObject
                        pointer-events="none"
                        width="100%"
                        height="100%"
                        style="overflow: visible; text-align: left"
                      >
                        <div
                          xmlns="http://www.w3.org/1999/xhtml"
                          style="
                            display: flex;
                            align-items: unsafe center;
                            justify-content: unsafe center;
                            width: 101px;
                            height: 1px;
                            padding-top: 30px;
                            margin-left: 201px;
                          "
                        >
                          <div
                            data-drawio-colors="color: rgb(0, 0, 0); "
                            style="box-sizing: border-box; font-size: 0; text-align: center"
                          >
                            <div
                              style="
                                display: inline-block;
                                font-size: 0.65rem;
                                font-family: 'Atkinson Hyperlegible', serif;
                                line-height: 1.2;
                                pointer-events: all;
                                white-space: normal;
                                overflow-wrap: normal;
                              "
                            >
                              <b>App 2</b>
                            </div>
                          </div>
                        </div>
                      </foreignObject>
                      <text x="251" y="34" font-size="1rem" text-anchor="middle">App 2</text>
                    </switch>
                  </g>
                </g>
              </g>
              <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-9">
                <g>
                  <rect
                    x="280"
                    y="5"
                    width="16.1"
                    height="15"
                    fill="none"
                    stroke="none"
                    pointer-events="all"
                  />
                  <path
                    d="M 281.05 15.55 L 295.05 15.55 L 295.05 6.17 L 281.05 6.17 Z M 280.8 16.72 C 280.44 16.72 280 16.33 280 15.8 L 280 5.94 C 280 5.44 280.4 5 280.79 5 L 295.3 5 C 295.72 5 296.1 5.46 296.1 5.92 L 296.1 15.79 C 296.1 16.21 295.8 16.72 295.27 16.72 L 289.89 16.72 C 289.8 17.07 289.72 17.42 289.72 17.76 C 289.72 18.34 290.02 18.57 290.47 18.7 C 291.02 18.84 291.61 18.84 292.19 18.85 C 292.44 18.85 292.71 19.08 292.71 19.45 C 292.71 19.74 292.47 20 292.25 20 L 283.84 20 C 283.6 20 283.35 19.75 283.35 19.46 C 283.35 19.12 283.56 18.85 283.85 18.85 C 284.53 18.83 285.42 18.84 285.94 18.58 C 286.17 18.45 286.36 18.26 286.38 17.84 C 286.4 17.47 286.3 17.09 286.21 16.72 Z"
                    class="systemIcon"
                    pointer-events="all"
                  />
                </g>
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-10">
              <g>
                <path
                  d="M 251 270 L 251.25 191"
                  class="path"
                  stroke-miterlimit="10"
                  stroke-dasharray="3 3"
                  pointer-events="stroke"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-14">
              <g>
                <path
                  d="M 242 199 L 197.02 199 L 63.15 199"
                  class="path"
                  stroke-miterlimit="10"
                  stroke-dasharray="3 3"
                  pointer-events="stroke"
                />
                <path
                  class="path"
                  d="M 72.04 194 L 62.04 199 L 72.04 204"
                  fill="none"
                  stroke-miterlimit="10"
                  pointer-events="all"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-11">
              <g>
                <rect
                  class="execution"
                  x="242"
                  y="129"
                  width="19"
                  height="77"
                  rx="2.85"
                  ry="2.85"
                  fill="#9ca3af"
                  stroke="#6b7280"
                  pointer-events="all"
                />
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-12">
              <g>
                <rect
                  class="rect"
                  x="115"
                  y="111"
                  width="73.5"
                  height="20"
                  rx="3"
                  ry="3"
                  fill="#fafafa"
                  stroke="#6b7280"
                  pointer-events="all"
                />
              </g>
              <g>
                <g transform="translate(-0.5 -0.5)">
                  <switch>
                    <foreignObject
                      pointer-events="none"
                      width="100%"
                      height="100%"
                      style="overflow: visible; text-align: left"
                    >
                      <div
                        xmlns="http://www.w3.org/1999/xhtml"
                        style="
                          display: flex;
                          align-items: unsafe center;
                          justify-content: unsafe center;
                          width: 72px;
                          height: 1px;
                          padding-top: 121px;
                          margin-left: 116px;
                        "
                      >
                        <div
                          data-drawio-colors="color: rgb(0, 0, 0); "
                          style="box-sizing: border-box; font-size: 0; text-align: center"
                        >
                          <div
                            style="
                              display: inline-block;
                              font-size: 0.65rem;
                              font-family: 'Atkinson Hyperlegible', serif;
                              line-height: 1.2;
                              pointer-events: all;
                              white-space: normal;
                              overflow-wrap: normal;
                            "
                          >
                            call()
                          </div>
                        </div>
                      </div>
                    </foreignObject>
                    <text x="152" y="125" font-size="1rem" text-anchor="middle">call()</text>
                  </switch>
                </g>
              </g>
            </g>
            <g data-cell-id="36PGRzWmKIFTyk_Fwc6N-16">
              <g>
                <rect
                  class="rect"
                  x="115"
                  y="172"
                  width="73.5"
                  height="20"
                  rx="3"
                  ry="3"
                  fill="#fafafa"
                  stroke="#6b7280"
                  pointer-events="all"
                />
              </g>
              <g>
                <g transform="translate(-0.5 -0.5)">
                  <switch>
                    <foreignObject
                      pointer-events="none"
                      width="100%"
                      height="100%"
                      style="overflow: visible; text-align: left"
                    >
                      <div
                        xmlns="http://www.w3.org/1999/xhtml"
                        style="
                          display: flex;
                          align-items: unsafe center;
                          justify-content: unsafe center;
                          width: 72px;
                          height: 1px;
                          padding-top: 182px;
                          margin-left: 116px;
                        "
                      >
                        <div
                          data-drawio-colors="color: rgb(0, 0, 0); "
                          style="box-sizing: border-box; font-size: 0; text-align: center"
                        >
                          <div
                            style="
                              display: inline-block;
                              font-size: 0.65rem;
                              font-family: 'Atkinson Hyperlegible', serif;
                              line-height: 1.2;
                              pointer-events: all;
                              white-space: normal;
                              overflow-wrap: normal;
                            "
                          >
                            response()
                          </div>
                        </div>
                      </div>
                    </foreignObject>
                    <text x="152" y="186" font-size="1rem" text-anchor="middle">response()</text>
                  </switch>
                </g>
              </g>
            </g>
          </g>
        </g>
      </g>
    </svg>
  </div>
</template>

<script setup lang="ts">
import { computed, onMounted } from 'vue'

const props = defineProps(['dark'])

const isDark = computed(() => {
  return props.dark
})

onMounted(() => {
  switchThemeColor()
})

const switchThemeColor = () => {
  if (document) {
    const root = document.querySelector(':root')
    if (root) {
      if (isDark.value) {
        root.style.setProperty('--themeColor', `var(--tw-color-neutral-400)`)
        root.style.setProperty('--color', `#ffffff`)
        root.style.setProperty('--diagramBackgroundColor', `var(--tw-color-neutral-900)`)
        root.style.setProperty('--diagramRectStroke', `var(--tw-color-neutral-600)`)

        root.style.setProperty('--systemIconFill', `var(--tw-color-neutral-100)`)

        root.style.setProperty('--executionFill', `var(--tw-color-neutral-700)`)
        root.style.setProperty('--executionStroke', `var(--tw-color-neutral-600)`)
      } else {
        root.style.setProperty('--themeColor', `var(--tw-color-neutral-400)`)
        root.style.setProperty('--color', `#000000`)
        root.style.setProperty('--diagramBackgroundColor', `var(--tw-color-neutral-100)`)
        root.style.setProperty('--diagramRectStroke', `var(--tw-color-neutral-400)`)

        root.style.setProperty('--systemIconFill', `var(--tw-color-neutral-900)`)

        root.style.setProperty('--executionFill', `var(--tw-color-neutral-300)`)
        root.style.setProperty('--executionStroke', `var(--tw-color-neutral-400)`)
      }
    }
  }
}

watch(isDark, () => {
  switchThemeColor()
})
</script>

<style scoped>
.syncSvgParent {
  transition: var(--diagramColorTransition);
  color: var(--color);
}

@media screen(sm) {
  .syncSvgParent {
    max-width: 60%;
    margin-inline: auto;
  }
}

.systemIcon {
  transition: var(--diagramColorTransition);
  fill: var(--systemIconFill);
  stroke-width: 0;
}

.path {
  transition: var(--diagramColorTransition);
  stroke: var(--themeColor);
  fill: none;
}

.pathFilled {
  transition: var(--diagramColorTransition);
  stroke: none;
  fill: var(--themeColor);
}

.rect {
  transition: var(--diagramColorTransition);
  fill: var(--diagramBackgroundColor);
  stroke: var(--diagramRectStroke);
}

.execution {
  transition: var(--diagramColorTransition);
  fill: var(--executionFill);
  stroke: var(--executionStroke);
  stroke-width: 1;
}
</style>
